(()=>{"use strict";var e,t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var r=t.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var s=r.getElementsByTagName("script");s.length&&(e=s[s.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})(),function(e){e[e.unauthorized=401]="unauthorized",e[e.notFound=404]="notFound"}(e||(e={}));const r=class{constructor(e,t){this._baseLink=e,this._options=t}getResp({endpoint:e,options:t={}},r=(()=>{console.error("No callback for GET response")})){this.load("GET",e,r,t)}errorHandler(t){if(!t.ok)throw t.status!==e.unauthorized&&t.status!==e.notFound||console.log(`Sorry, but there is ${t.status} error: ${t.statusText}`),Error(t.statusText);return t}makeUrl(e,t){const r=Object.assign(Object.assign({},this._options),e);let s=`${this._baseLink}${t}?`;return Object.keys(r).forEach((e=>{s+=`${e}=${r[e]}&`})),s.slice(0,-1)}load(e,t,r,s={}){fetch(this.makeUrl(s,t),{method:e}).then(this.errorHandler).then((e=>e.json())).then((e=>r(e))).catch((e=>console.error(e)))}},s=class extends r{constructor(){super("https://newsapi-redirect-production.up.railway.app/",{apiKey:"beb9565b064d45e59d52c0a9c93178cf"})}},o=class extends s{getSources(e){super.getResp({endpoint:"sources"},e)}getNews(e,t){let r=e.target;const s=e.currentTarget;for(;r!==s;){if(r.classList.contains("source__item")){const e=r.getAttribute("data-source-id");return void(s.getAttribute("data-source")!==e&&(s.setAttribute("data-source",e),super.getResp({endpoint:"everything",options:{sources:e}},t)))}r=r.parentNode}}},n=t.p+"img/news_placeholder.jpg";class c{constructor(){this.news=new class{draw(e){const t=e.length>=10?e.filter(((e,t)=>t<10)):e,r=document.createDocumentFragment(),s=document.querySelector("#newsItemTemp");s instanceof HTMLTemplateElement&&t.forEach(((e,t)=>{const o=s.content.cloneNode(!0);if(o instanceof DocumentFragment){if(t%2){const e=o.querySelector(".news__item");e&&e.classList.add("alt")}const s=o.querySelector(".news__meta-photo");s&&(s.style.backgroundImage=`url(${e.urlToImage||n})`);const c=o.querySelector(".news__meta-author");c&&(c.textContent=e.author||e.source.name);const a=o.querySelector(".news__meta-date");a&&(a.textContent=e.publishedAt.slice(0,10).split("-").reverse().join("-"));const i=o.querySelector(".news__description-title");i&&(i.textContent=e.title);const u=o.querySelector(".news__description-source");u&&(u.textContent=e.source.name);const l=o.querySelector(".news__description-content");l&&(l.textContent=e.description);const d=o.querySelector(".news__read-more a");d&&d.setAttribute("href",e.url),r.append(o)}}));const o=document.querySelector(".news");o&&(o.innerHTML="",o.appendChild(r))}},this.sources=new class{draw(e,t){const r=document.createDocumentFragment(),s=document.querySelector("#sourceItemTemp");e.forEach((e=>{if(e.name[0]===t&&s){const t=s.content.cloneNode(!0);if(t instanceof DocumentFragment){const s=t.querySelector(".source__item-name");s&&(s.textContent=e.name);const o=t.querySelector(".source__item");o&&o.setAttribute("data-source-id",e.id),r.append(t)}}}));const o=document.querySelector(".sources");o&&o.append(r)}}}drawNews(e){if(e){const t=e.articles?e.articles:[];this.news.draw(t)}}drawSources(e,t){if(e){const r=e.sources?e.sources:[];this.sources.draw(r,t)}}}const a=document.querySelector(".main"),i=document.createElement("ul");i.classList.add("alfaBet"),a&&a.prepend(i),["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"].forEach((e=>{const t=document.createElement("li");t&&(t.classList.add("alfaBet__item"),t.textContent=e,i&&i.append(t))})),(new class{constructor(){this.app=new class{constructor(){this.controller=new o,this.view=new c}start(e){document.querySelector(".sources").innerHTML="",document.querySelector(".sources").addEventListener("click",(e=>this.controller.getNews(e,(e=>{if(e)return this.view.drawNews(e)})))),this.controller.getSources((t=>{if(t)return this.view.drawSources(t,e)}))}},this.letter="A"}showAlfaBet(){i.addEventListener("click",(e=>{const t=e.target;t.classList.contains("alfaBet__item")&&(document.querySelectorAll(".alfaBet__item").forEach((e=>{e.classList.remove("alfaBet__item_active")})),t.classList.toggle("alfaBet__item_active"),t.textContent&&(this.letter=t.textContent),this.app.start(this.letter))}))}}).showAlfaBet()})();